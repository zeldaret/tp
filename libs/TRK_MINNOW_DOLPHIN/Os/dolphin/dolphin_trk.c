//
// Generated By: dol2asm
// Translation Unit: Os/dolphin/dolphin_trk
//

#include "TRK_MINNOW_DOLPHIN/Os/dolphin/dolphin_trk.h"
#include "TRK_MINNOW_DOLPHIN/ppc/Generic/targimpl.h"
#include "dol2asm.h"
#include "dolphin/types.h"

//
// Forward References:
//

void InitMetroTRK();
void InitMetroTRK_BBA();
void TRK__write_aram();
void TRK__read_aram();
int TRKInitializeTarget();
void __TRK_copy_vectors();
u32 TRKTargetTranslate();
void EnableMetroTRKInterrupts();

//
// External References:
//

SECTION_INIT void TRK_memcpy();
extern u8 const __TRK_unknown_data[7988];
void ARGetDMAStatus();
void ARStartDMA();
void __ARClearInterrupt();
void __ARGetInterruptStatus();
void TRK_flush_cache();
void TRKSaveExtended1Block();
void TRK_main();
void EnableEXI2Interrupts();
void InitMetroTRKCommTable();
void regist__9daBgObj_cFP4dBgW();

//
// Declarations:
//

/* 80371560-803715F8 36BEA0 0098+00 0/0 1/1 0/0 .text InitMetroTRK */
#pragma push
#pragma optimization_level 0
#pragma optimizewithasm off
asm void InitMetroTRK() {
    nofralloc
#include "asm/TRK_MINNOW_DOLPHIN/Os/dolphin/dolphin_trk/InitMetroTRK.s"
}
#pragma pop

/* 803715F8-8037168C 36BF38 0094+00 0/0 1/1 0/0 .text            InitMetroTRK_BBA */
#pragma push
#pragma optimization_level 0
#pragma optimizewithasm off
asm void InitMetroTRK_BBA() {
    nofralloc
#include "asm/TRK_MINNOW_DOLPHIN/Os/dolphin/dolphin_trk/InitMetroTRK_BBA.s"
}
#pragma pop

/* 8037168C-80371878 36BFCC 01EC+00 0/0 1/1 0/0 .text            TRK__write_aram */
#pragma push
#pragma optimization_level 0
#pragma optimizewithasm off
asm void TRK__write_aram() {
    nofralloc
#include "asm/TRK_MINNOW_DOLPHIN/Os/dolphin/dolphin_trk/TRK__write_aram.s"
}
#pragma pop

/* 80371878-803719AC 36C1B8 0134+00 0/0 1/1 0/0 .text            TRK__read_aram */
#pragma push
#pragma optimization_level 0
#pragma optimizewithasm off
asm void TRK__read_aram() {
    nofralloc
#include "asm/TRK_MINNOW_DOLPHIN/Os/dolphin/dolphin_trk/TRK__read_aram.s"
}
#pragma pop

/* ############################################################################################## */
/* 8044F810-8044F818 07C530 0004+04 3/3 0/0 0/0 .bss             lc_base */
SECTION_BSS static u32 lc_base[1 + 1 /*padding*/];

/* 803719AC-803719F8 36C2EC 004C+00 0/0 1/1 0/0 .text TRKInitializeTarget */
int TRKInitializeTarget() {
    gTRKState.target = 1;
    gTRKState.msr = __TRK_get_MSR();
    *lc_base = 0xE0000000;
    return 0;
}

/* ############################################################################################## */
/* 803D3268-803D32A8 030388 003C+04 1/1 0/0 0/0 .data            TRK_ISR_OFFSETS */
SECTION_DATA static u8 TRK_ISR_OFFSETS[60 + 4 /* padding */] = {
    0x00,
    0x00,
    0x01,
    0x00,
    0x00,
    0x00,
    0x02,
    0x00,
    0x00,
    0x00,
    0x03,
    0x00,
    0x00,
    0x00,
    0x04,
    0x00,
    0x00,
    0x00,
    0x05,
    0x00,
    0x00,
    0x00,
    0x06,
    0x00,
    0x00,
    0x00,
    0x07,
    0x00,
    0x00,
    0x00,
    0x08,
    0x00,
    0x00,
    0x00,
    0x09,
    0x00,
    0x00,
    0x00,
    0x0C,
    0x00,
    0x00,
    0x00,
    0x0D,
    0x00,
    0x00,
    0x00,
    0x0F,
    0x00,
    0x00,
    0x00,
    0x13,
    0x00,
    0x00,
    0x00,
    0x14,
    0x00,
    0x00,
    0x00,
    0x17,
    0x00,
    /* padding */
    0x00,
    0x00,
    0x00,
    0x00,
};

/* 803719F8-80371B24 36C338 012C+00 0/0 1/1 0/0 .text            __TRK_copy_vectors */
#pragma push
#pragma optimization_level 0
#pragma optimizewithasm off
asm void __TRK_copy_vectors() {
    nofralloc
#include "asm/TRK_MINNOW_DOLPHIN/Os/dolphin/dolphin_trk/__TRK_copy_vectors.s"
}
#pragma pop

/* 80371B24-80371B7C 36C464 0058+00 0/0 1/1 0/0 .text            TRKTargetTranslate */
u32 TRKTargetTranslate(u32 param_0) {
    if (param_0 >= *lc_base) {
        if ((param_0 < *lc_base + 0x4000) && ((gTRKCPUState.field_0x84[109] & 3) != 0)) {
            return param_0;
        }
    }
    if ((0x7E000000 <= param_0) && (param_0 <= 0x80000000)) {
        return param_0;
    }
    return param_0 & 0x3FFFFFFF | 0x80000000;
}

/* 80371B7C-80371B9C 36C4BC 0020+00 0/0 1/1 0/0 .text EnableMetroTRKInterrupts */
void EnableMetroTRKInterrupts() {
    EnableEXI2Interrupts();
}
