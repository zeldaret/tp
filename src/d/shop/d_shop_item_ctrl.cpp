//
// Generated By: dol2asm
// Translation Unit: d/shop/d_shop_item_ctrl
//

#include "d/shop/d_shop_item_ctrl.h"
#include "SSystem/SComponent/c_lib.h"
#include "d/a/d_a_shop_item_static.h"
#include "dol2asm.h"
#include "f_op/f_op_actor_mng.h"

//
// Forward References:
//

extern "C" void __ct__15dShopItemCtrl_cFv();
extern "C" void __dt__15dShopItemCtrl_cFv();
extern "C" void getCurrentPos__15dShopItemCtrl_cFi();
extern "C" void isHomePos__15dShopItemCtrl_cFi();
extern "C" void setRotateAnime__15dShopItemCtrl_cFi();
extern "C" void setZoomAnime__15dShopItemCtrl_cFiP4cXyzsb();

//
// External References:
//

extern "C" void fopAcIt_Judge__FPFPvPv_PvPv();
extern "C" void fpcSch_JudgeByID__FPvPv();
extern "C" void getRotateP__12daShopItem_cFv();
extern "C" void getPosP__12daShopItem_cFv();
extern "C" void __mi__4cXyzCFRC3Vec();
extern "C" void cLib_addCalcPos2__FP4cXyzRC4cXyzff();
extern "C" void cLib_addCalcAngleS__FPsssss();
extern "C" void __dl__FPv();
extern "C" void _savegpr_23();
extern "C" void _savegpr_27();
extern "C" void _restgpr_23();
extern "C" void _restgpr_27();

//
// Declarations:
//

/* 80196914-80196958 191254 0044+00 0/0 0/0 10/10 .text            __ct__15dShopItemCtrl_cFv */
dShopItemCtrl_c::dShopItemCtrl_c() {
    for (int i = 0; i < 7; i++) {
        mItemIndex[i] = -1;
        mMessageIndex[i] = 0;
    }
}

/* 80196958-801969A0 191298 0048+00 1/0 1/1 0/0 .text            __dt__15dShopItemCtrl_cFv */
dShopItemCtrl_c::~dShopItemCtrl_c() {}

/* ############################################################################################## */
/* 80453AD0-80453AD8 0020D0 0004+04 2/2 0/0 0/0 .sdata2          @3659 */
SECTION_SDATA2 static f32 lit_3659[1 + 1 /* padding */] = {
    0.0f,
    /* padding */
    0.0f,
};

/* 801969A0-80196A3C 1912E0 009C+00 0/0 3/3 3/3 .text            getCurrentPos__15dShopItemCtrl_cFi
 */
cXyz dShopItemCtrl_c::getCurrentPos(int item_index) {
    f32 tmp = lit_3659[0];
    cXyz item_pos(tmp, tmp, tmp);

    if (mItemIndex[item_index] != -1) {
        fopAc_ac_c* item = fopAcM_SearchByID(mItemIndex[item_index]);
        if (item != NULL) {
            item_pos.set(item->current.pos);
        }
    }

    return item_pos;
}

/* 80196A3C-80196AF0 19137C 00B4+00 0/0 2/2 0/0 .text            isHomePos__15dShopItemCtrl_cFi */
bool dShopItemCtrl_c::isHomePos(int item_index) {
    if (item_index >= 0 && item_index < 7 && mItemIndex[item_index] != -1) {
        daShopItem_c* item = (daShopItem_c*)fopAcM_SearchByID(mItemIndex[item_index]);
        if (item != NULL) {
            cXyz* item_pos = item->getPosP();
            cXyz item_home = item->orig.pos;

            if (item_pos->x == item_home.x && item_pos->y == item_home.y &&
                item_pos->z == item_home.z) {
                return true;
            }
        }
    }

    return false;
}

/* 80196AF0-80196BA4 191430 00B4+00 0/0 1/1 0/0 .text            setRotateAnime__15dShopItemCtrl_cFi
 */
void dShopItemCtrl_c::setRotateAnime(int item_index) {
    for (int i = 0; i < 7; i++) {
        if (mItemIndex[i] != -1) {
            daShopItem_c* item = (daShopItem_c*)fopAcM_SearchByID(mItemIndex[i]);
            if (item != NULL) {
                csXyz* item_rot = item->getRotateP();

                if (i == item_index - 1) {
                    item_rot->y += 0x200;
                } else {
                    cLib_addCalcAngleS(&item_rot->y, item->orig.angle.y, 4, 0x800, 0x80);
                }
            }
        }
    }
}

/* ############################################################################################## */
/* 80453AD8-80453AE0 0020D8 0008+00 1/1 0/0 0/0 .sdata2          @3838 */
SECTION_SDATA2 static f64 lit_3838 = 0.5;

/* 80453AE0-80453AE8 0020E0 0008+00 1/1 0/0 0/0 .sdata2          @3839 */
SECTION_SDATA2 static f64 lit_3839 = 3.0;

/* 80453AE8-80453AF0 0020E8 0008+00 1/1 0/0 0/0 .sdata2          @3840 */
SECTION_SDATA2 static u8 lit_3840[8] = {
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
};

/* 80453AF0-80453AF4 0020F0 0004+00 1/1 0/0 0/0 .sdata2          @3841 */
SECTION_SDATA2 static f32 lit_3841 = 0.5f;

/* 80453AF4-80453AF8 0020F4 0004+00 1/1 0/0 0/0 .sdata2          @3842 */
SECTION_SDATA2 static f32 lit_3842 = 1.0f / 20.0f;

/* 80453AF8-80453AFC 0020F8 0004+00 1/1 0/0 0/0 .sdata2          @3843 */
SECTION_SDATA2 static f32 lit_3843 = 1.0f / 10.0f;

/* 80453AFC-80453B00 0020FC 0004+00 1/1 0/0 0/0 .sdata2          @3844 */
SECTION_SDATA2 static f32 lit_3844 = 1.0f / 100.0f;

/* 80196BA4-80197098 1914E4 04F4+00 0/0 1/1 0/0 .text setZoomAnime__15dShopItemCtrl_cFiP4cXyzsb */
#pragma push
#pragma optimization_level 0
#pragma optimizewithasm off
asm void dShopItemCtrl_c::setZoomAnime(int param_0, cXyz* param_1, s16 param_2, bool param_3) {
    nofralloc
#include "asm/d/shop/d_shop_item_ctrl/setZoomAnime__15dShopItemCtrl_cFiP4cXyzsb.s"
}
#pragma pop
